Bootstrap: docker
From: feelpp/feelpp-toolboxes:latest

%setup
    echo "Looking in directory '$SINGULARITY_ROOTFS' for /bin/sh"
    if [ ! -x "$SINGULARITY_ROOTFS/bin/sh" ]; then
        echo "Hrmm, this container does not have /bin/sh installed..."
        exit 1
    fi
    cp includes/environment $SINGULARITY_ROOTFS/
    cp includes/shell $SINGULARITY_ROOTFS/.shell
    exit 0

%post
    export PATH=$PATH:/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin
    echo "Post install"
    cat /etc/bash.bashrc | sed 's/\(PS1=.*$\)/#\1/g' > /etc/bash.bashrc
    mv /home/feelpp /opt/feelpp
    rm -rf `find /opt/feelpp -name ".*" ! -path .`
    echo "alias ls='ls --color=auto'" >> /etc/bash.bashrc
    echo "alias ll='ls -ls'" >> /etc/bash.bashrc
    echo "alias grep='grep --color'" >> /etc/bash.bashrc
    exit 0

%runscript
    echo "Arguments received: $*"
    exec /usr/bin/python "$@"
